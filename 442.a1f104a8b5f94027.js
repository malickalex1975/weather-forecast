"use strict";(self.webpackChunkweather_forecast=self.webpackChunkweather_forecast||[]).push([[442],{442:(I,b,h)=>{h.r(b),h.d(b,{CameraGameModule:()=>m});var y=h(6895),M=h(9197);function _(x,a,i,n,o,e,l){try{var d=x[e](l),s=d.value}catch(c){return void i(c)}d.done?a(s):Promise.resolve(s).then(n,o)}function f(x){return function(){var a=this,i=arguments;return new Promise(function(n,o){var e=x.apply(a,i);function l(s){_(e,n,o,l,d,"next",s)}function d(s){_(e,n,o,l,d,"throw",s)}l(void 0)})}}var w=h(1135),t=h(4650);class v{constructor(){this.isBigCanvas=!1,this.dataArray=[],this.averageR=0,this.averageG=0,this.averageB=0,this.averageA=255,this.isSaveButton=!1,this.dataUrl="",this.x=0,this.y=0}ngOnInit(){this.averageColor$$=new w.X(`rgba(${this.averageR},${this.averageG},${this.averageB},${this.averageA}`),document.querySelector(".controls");const i=document.querySelector(".video-options>select"),n=document.querySelector("video"),o=document.querySelector(".canvas"),e=document.querySelector(".canvas-2");e.addEventListener("mousemove",r=>{let g=e.getBoundingClientRect().x,u=e.getBoundingClientRect().y;this.x=r.clientX-g,this.y=r.clientY-u,this.drawCanvas(this.x,this.y)});const l=document.querySelector("img"),d=document.querySelectorAll(".btn"),s=document.querySelector(".save-button");let c=!1;const[A,Z,B]=[...d],P={video:!0},U=function(){var r=f(function*(){const $=(yield navigator.mediaDevices.enumerateDevices()).filter(C=>"videoinput"===C.kind).map(C=>`<option value="${C.deviceId}">${C.label}</option>`);i.innerHTML=$.join("")});return function(){return r.apply(this,arguments)}}();A.onclick=f(function*(){if(c)n.play();else if("mediaDevices"in navigator){const r={...P,deviceId:{exact:i.value}};O(r)}});const O=function(){var r=f(function*(g){const u=yield navigator.mediaDevices.getUserMedia(g);k(u)});return function(u){return r.apply(this,arguments)}}(),k=r=>{n.srcObject=r,c=!0,this.isSaveButton=!1};i.onchange=()=>{const r={...P,deviceId:{exact:i.value}};O(r)},Z.onclick=()=>{n.pause()},B.onclick=()=>{o.width=n.videoWidth,o.height=n.videoHeight,o.getContext("2d").drawImage(n,0,0),l.src=o.toDataURL("image/webp");let r=o.getContext("2d")?.getImageData(0,0,n.videoWidth,n.videoHeight);this.dataArray=Array.from(r.data),this.createAverageColor(this.dataArray);let g=new ImageData(this.createInverseImage(r.data),n.videoWidth,n.videoHeight,{colorSpace:"srgb"});e.width=n.videoWidth,e.height=n.videoHeight,e.getContext("2d")?.putImageData(g,0,0),this.dataUrl=e.toDataURL("image/webp"),this.dataUrl&&(this.isSaveButton=!0,s.href=this.dataUrl)},U()}createAverageColor(a){let n=a.length/4,o=[],e=[],l=[],d=[];for(let s=0;s<n;s++)o.push(a[4*s+0]),e.push(a[4*s+1]),l.push(a[4*s+2]),d.push(a[4*s+3]);this.averageR=Math.round(o.reduce((s,c)=>s+c,0)/n),this.averageG=Math.round(e.reduce((s,c)=>s+c,0)/n),this.averageB=Math.round(l.reduce((s,c)=>s+c,0)/n),this.averageA=Math.round(d.reduce((s,c)=>s+c,0)/n),this.averageColor$$?.next(`rgba(${this.averageR},${this.averageG},${this.averageB},${this.averageA}`)}createMonoImage(a){let i=a.length,n=i/4,o=new Uint8ClampedArray(i);for(let e=0;e<n;e++){let c=Math.round((a[4*e+0]+a[4*e+1]+a[4*e+2])/3);o[4*e+0]=c,o[4*e+1]=c,o[4*e+2]=c,o[4*e+3]=a[4*e+3]}return o}createInverseImage(a){let i=a.length,n=i/4,o=new Uint8ClampedArray(i);for(let e=0;e<n;e++)o[4*e+0]=Math.abs(a[4*e+0]-255),o[4*e+1]=Math.abs(a[4*e+1]-255),o[4*e+2]=Math.abs(a[4*e+2]-255),o[4*e+3]=a[4*e+3];return o}drawCanvas(a,i){let o=document.querySelector(".canvas-2").getContext("2d");o.strokeStyle="red",o.beginPath(),o.moveTo(0,0),o.lineWidth=1,o.lineTo(150,100),o.lineTo(0,20),o.stroke()}clearCanvas(){const a=document.querySelector(".canvas-2");a.getContext("2d").clearRect(0,0,a.width,a.height)}static#t=this.\u0275fac=function(i){return new(i||v)};static#e=this.\u0275cmp=t.Xpm({type:v,selectors:[["app-camera-game"]],decls:24,vars:11,consts:[[1,"display-cover"],["autoplay",""],["draggable","true",1,"canvas","d-none",3,"click"],[1,"canvas-2"],[1,"video-options"],["name","","id","",1,"custom-select"],["value",""],["href","#",1,"save-button",3,"download"],[1,"average-color"],["alt","",1,"screenshot-image","d-none"],[1,"controls"],["title","Play",1,"btn","btn-danger","play"],["data-feather","play-circle"],["title","Pause",1,"btn","btn-info","pause","d-none"],["data-feather","pause"],["title","ScreenShot",1,"btn","btn-outline-success","screenshot","d-none"],["data-feather","image"],[3,"click"]],template:function(i,n){1&i&&(t.TgZ(0,"div",0),t._UZ(1,"video",1),t.TgZ(2,"canvas",2),t.NdJ("click",function(){return n.isBigCanvas=!n.isBigCanvas}),t.qZA(),t._UZ(3,"canvas",3),t.TgZ(4,"div",4)(5,"select",5)(6,"option",6),t._uU(7,"Select camera"),t.qZA()()(),t.TgZ(8,"a",7),t._uU(9,"Save"),t.qZA(),t.TgZ(10,"div",8),t.ALo(11,"async"),t.qZA(),t._UZ(12,"img",9),t.TgZ(13,"div",10)(14,"button",11),t._UZ(15,"i",12),t.qZA(),t.TgZ(16,"button",13),t._UZ(17,"i",14),t.qZA(),t.TgZ(18,"button",15),t._UZ(19,"i",16),t.qZA(),t.TgZ(20,"button",17),t.NdJ("click",function(){return n.clearCanvas()}),t._uU(21,"clear canvas"),t.qZA(),t.TgZ(22,"p"),t._uU(23),t.qZA()()()),2&i&&(t.xp6(2),t.Udp("width",n.isBigCanvas?"40vw":"20vw"),t.xp6(6),t.ekj("visible",n.isSaveButton),t.Q6J("download","my_photo.png"),t.xp6(2),t.Udp("background-color",t.lcZ(11,9,n.averageColor$$)),t.xp6(13),t.AsE("",n.x," ",n.y,""))},dependencies:[y.Ov],styles:[".screenshot-image[_ngcontent-%COMP%]{width:150px;height:90px;border-radius:4px;border:2px solid whitesmoke;box-shadow:0 1px 2px #0000001a;position:absolute;bottom:5px;left:10px;background:white}.canvas[_ngcontent-%COMP%]{position:fixed;right:50px;bottom:50px;width:20vw;padding:50px}.canvas-2[_ngcontent-%COMP%]{position:fixed;left:50px;bottom:50px;width:300px;height:300px;padding:0;border:2px solid rgb(236,36,36)}.save-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;text-decoration:none;width:50px;height:30px;position:fixed;left:50px;bottom:170px;opacity:0;visibility:hidden}.save-button[_ngcontent-%COMP%]:hover{background-color:#eee}.visible[_ngcontent-%COMP%]{opacity:1;visibility:visible}.average-color[_ngcontent-%COMP%]{position:fixed;left:50vw;bottom:50px;width:50px;height:50px;border:2px solid red;padding:50px}.display-cover[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:70%;margin:5% auto;position:relative}video[_ngcontent-%COMP%]{width:40vw;background:rgba(0,0,0,.2)}.video-options[_ngcontent-%COMP%]{position:absolute;left:20px;top:30px}.controls[_ngcontent-%COMP%]{position:fixed;right:20px;top:120px;display:flex}.controls[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{color:#fff!important}@media (min-width: 300px) and (max-width: 400px){.controls[_ngcontent-%COMP%]{flex-direction:column}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:5px 0!important}}.controls[_ngcontent-%COMP%] > button[_ngcontent-%COMP%] > svg[_ngcontent-%COMP%]{height:20px;width:18px;text-align:center;margin:0 auto;padding:0}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(1){border:2px solid #D2002E}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(1)   svg[_ngcontent-%COMP%]{color:#d2002e}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(2){border:2px solid #008496}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(2)   svg[_ngcontent-%COMP%]{color:#008496}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(3){border:2px solid #00B541}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(3)   svg[_ngcontent-%COMP%]{color:#00b541}.controls[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{width:45px;height:45px;text-align:center;border-radius:100%;margin:0 6px;background:transparent}.controls[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{color:#fff}"]})}const S=[{path:"",component:v}];class p{static#t=this.\u0275fac=function(i){return new(i||p)};static#e=this.\u0275mod=t.oAB({type:p});static#n=this.\u0275inj=t.cJS({imports:[M.Bz.forChild(S),M.Bz]})}class m{static#t=this.\u0275fac=function(i){return new(i||m)};static#e=this.\u0275mod=t.oAB({type:m});static#n=this.\u0275inj=t.cJS({imports:[y.ez,p]})}}}]);