"use strict";(self.webpackChunkweather_forecast=self.webpackChunkweather_forecast||[]).push([[567],{7567:(it,O,c)=>{c.r(O),c.d(O,{MainModule:()=>P});var u=c(6895),$=c(195),t=c(8256);class _{static#t=this.\u0275fac=function(e){return new(e||_)};static#e=this.\u0275cmp=t.Xpm({type:_,selectors:[["app-not-found"]],decls:2,vars:0,template:function(e,s){1&e&&(t.TgZ(0,"p"),t._uU(1,"not-found works!"),t.qZA())}})}var a=c(4854),M=c(1135),I=c(2323);class h{constructor(n){this.storage=n,this.placesArray$$=new M.X([])}remember(n){let e=this.getLastPlaces();e.some(s=>s.name===n.name&&s.country===n.country&&s.state===n.state)||(e.push(n),this.storage.setItem(a.I,JSON.stringify(e)),this.emitPlaces())}getLastPlaces(){return JSON.parse(this.storage.getItem(a.I)||"[]")}emitPlaces(){this.placesArray$$.next(this.getLastPlaces())}getSubject(){return this.emitPlaces(),this.placesArray$$}clearPlaces(){this.storage.setItem(a.I,JSON.stringify([])),this.emitPlaces()}delete(n){console.log("delete",n);let e=this.getLastPlaces();e=e.filter(s=>s.name!==n.name&&s.country!==n.country&&s.state!==n.state),this.storage.setItem(a.I,JSON.stringify(e)),this.emitPlaces()}static#t=this.\u0275fac=function(e){return new(e||h)(t.LFG(I.V))};static#e=this.\u0275prov=t.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})}class p{constructor(){this.request$$=new M.X(""),this.coords$$=new M.X([void 0,void 0])}getRequest(){return this.request$$}getCoords(){return this.coords$$}setRequest(n){let e=n.trim();this.request$$.next(e.length>3?e:"")}setCoords(n,e){this.coords$$.next([n,e])}static#t=this.\u0275fac=function(e){return new(e||p)};static#e=this.\u0275prov=t.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"})}var Z=c(5593);function F(r,n){1&r&&(t.TgZ(0,"p"),t._uU(1,"Last searching:"),t.qZA())}function L(r,n){if(1&r){const e=t.EpF();t.TgZ(0,"button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.clear())}),t._uU(1," Clear "),t.qZA()}}function S(r,n){if(1&r){const e=t.EpF();t.TgZ(0,"div",6),t.NdJ("click",function(){const o=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.callPlace(o))})("mouseenter",function(){const o=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.hovered=o)})("mouseleave",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.hovered=null)}),t.TgZ(1,"div",7),t._uU(2),t.qZA(),t._UZ(3,"div",8),t.TgZ(4,"p",9),t.NdJ("click",function(){const o=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.delete(o))}),t._uU(5,"x"),t.qZA()()}if(2&r){const e=n.$implicit,s=t.oxw(2);t.xp6(2),t.lnq(" ",null==e?null:e.name,", ",null==e?null:e.country,", ",null==e?null:e.state," "),t.xp6(1),t.Akn(s.getFlagStyle(e.country)),t.xp6(1),t.ekj("visible",s.hovered==e)}}function U(r,n){if(1&r&&(t.TgZ(0,"div",1),t.YNc(1,F,2,0,"p",2),t.YNc(2,L,2,0,"button",3),t.YNc(3,S,6,7,"div",4),t.qZA()),2&r){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.length>0),t.xp6(1),t.Q6J("ngIf",e.length>0),t.xp6(1),t.Q6J("ngForOf",e)}}class m{constructor(n,e){this.rememberPlaces=n,this.requestService=e,this.places$$=this.rememberPlaces.getSubject()}callPlace(n){this.requestService.setRequest(n.name),this.requestService.setCoords(n.lat,n.lon),window.scrollTo(0,0)}clear(){this.rememberPlaces.clearPlaces()}delete(n){this.rememberPlaces.delete(n)}getFlagStyle(n){return`background-image: url(assets/img/png/${n.toLowerCase()}.png)`}static#t=this.\u0275fac=function(e){return new(e||m)(t.Y36(h),t.Y36(p))};static#e=this.\u0275cmp=t.Xpm({type:m,selectors:[["app-last-places"]],decls:1,vars:1,consts:[["class","places-container",4,"ngrxLet"],[1,"places-container"],[4,"ngIf"],["class","clear",3,"click",4,"ngIf"],["class","main-container",3,"click","mouseenter","mouseleave",4,"ngFor","ngForOf"],[1,"clear",3,"click"],[1,"main-container",3,"click","mouseenter","mouseleave"],[1,"item-container"],[1,"flag"],[1,"delete",3,"click"]],template:function(e,s){1&e&&t.YNc(0,U,4,3,"div",0),2&e&&t.Q6J("ngrxLet",s.places$$)},dependencies:[u.sg,u.O5,Z.eJ],styles:["*[_ngcontent-%COMP%]{padding:0;margin:0}.main-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-evenly;width:300px;background-color:#cceeffb3;box-shadow:1px 1px 2px #0486f1}.main-container[_ngcontent-%COMP%]:hover{opacity:1;box-shadow:1px 1px 5px #646464;background-color:#cef;transition:.2s}.places-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:300px;height:100%;overflow-y:auto;overflow-x:hidden;gap:10px;padding:10px;margin-bottom:100px;margin-left:auto;margin-right:auto}.item-container[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;justify-content:center;width:280px;height:-moz-fit-content;height:fit-content;opacity:.7}.clear[_ngcontent-%COMP%]{width:100px;margin-bottom:20px;border:5px solid transparent;cursor:pointer;opacity:.7;background-color:transparent}.clear[_ngcontent-%COMP%]:hover{opacity:1;background-color:#cef;box-shadow:1px 1px 5px #646464;transition:.2s}.disabled[_ngcontent-%COMP%]{cursor:auto;opacity:.7;background-color:#cceeff4d}.disabled[_ngcontent-%COMP%]:hover{opacity:.7;background-color:#cceeff4d;box-shadow:0 0 #646464}.delete[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;color:#0486f1;visibility:hidden;position:relative;width:20px;height:20px;border-radius:50%;left:0;top:0;transition:.1s;font-size:20px}.visible[_ngcontent-%COMP%]{visibility:visible;cursor:pointer}.visible[_ngcontent-%COMP%]:hover{background-color:#eee}.flag[_ngcontent-%COMP%]{width:22px;height:14px;background-repeat:no-repeat;background-size:cover}"]})}var j=c(9646),T=c(3900),J=c(727);class N extends J.w0{constructor(n,e){super()}schedule(n,e=0){return this}}const y={setInterval(r,n,...e){const{delegate:s}=y;return s?.setInterval?s.setInterval(r,n,...e):setInterval(r,n,...e)},clearInterval(r){const{delegate:n}=y;return(n?.clearInterval||clearInterval)(r)},delegate:void 0};var Y=c(8737),G=c(6063);class f{constructor(n,e=f.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,s){return new this.schedulerActionCtor(this,n).schedule(s,e)}}f.now=G.l.now;const W=new class R extends f{constructor(n,e=f.now){super(n,e),this.actions=[],this._active=!1}flush(n){const{actions:e}=this;if(this._active)return void e.push(n);let s;this._active=!0;do{if(s=n.execute(n.state,n.delay))break}while(n=e.shift());if(this._active=!1,s){for(;n=e.shift();)n.unsubscribe();throw s}}}(class z extends N{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){var s;if(this.closed)return this;this.state=n;const i=this.id,o=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(o,i,e)),this.pending=!0,this.delay=e,this.id=null!==(s=this.id)&&void 0!==s?s:this.requestAsyncId(o,this.id,e),this}requestAsyncId(n,e,s=0){return y.setInterval(n.flush.bind(n,this),s)}recycleAsyncId(n,e,s=0){if(null!=s&&this.delay===s&&!1===this.pending)return e;null!=e&&y.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const s=this._execute(n,e);if(s)return s;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let i,s=!1;try{this.work(n)}catch(o){s=!0,i=o||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:n,scheduler:e}=this,{actions:s}=e;this.work=this.state=this.scheduler=null,this.pending=!1,(0,Y.P)(s,this),null!=n&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}});var E=c(4482),H=c(5403),k=c(529);class d{constructor(n){this.http=n}getPlaces(n){return this.http.get(a.Em+`?q=${n}&limit=5&appid=${a.$h}`)}getCurrentWeather(n,e,s="metric",i="en"){return this.http.get(a.LX+`lat=${n}&lon=${e}&appid=${a.$h}&units=${s}&lang=${i}`)}static#t=this.\u0275fac=function(e){return new(e||d)(t.LFG(k.eN))};static#e=this.\u0275prov=t.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}class x{constructor(n,e){this.http=n,this.requestService=e,this.places=(0,j.of)([])}findPlaces(){return this.places.pipe((0,T.w)(()=>this.requestService.getRequest()),function Q(r,n=W){return(0,E.e)((e,s)=>{let i=null,o=null,l=null;const w=()=>{if(i){i.unsubscribe(),i=null;const g=o;o=null,s.next(g)}};function st(){const g=l+r,q=n.now();if(q<g)return i=this.schedule(void 0,g-q),void s.add(i);w()}e.subscribe((0,H.x)(s,g=>{o=g,l=n.now(),i||(i=n.schedule(st,r),s.add(i))},()=>{w(),s.complete()},void 0,()=>{o=i=null}))})}(1e3),(0,T.w)(n=>(n||(n=" "),this.http.getPlaces(n))))}static#t=this.\u0275fac=function(e){return new(e||x)(t.LFG(d),t.LFG(p))};static#e=this.\u0275prov=t.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"})}var K=c(4004);class v{constructor(n){this.http=n}getIP(){return this.http.get("https://jsonip.com")}getPlace(){return this.getIP().pipe((0,K.U)(n=>n.ip),(0,T.w)(n=>this.http.get(`https://ipwho.is/${n}`)))}static#t=this.\u0275fac=function(e){return new(e||v)(t.LFG(k.eN))};static#e=this.\u0275prov=t.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"})}var X=c(1843),A=c(433);function B(r,n){if(1&r){const e=t.EpF();t.TgZ(0,"div",9),t.NdJ("click",function(){const o=t.CHM(e).$implicit,l=t.oxw(2);return l.getCurrentWeather(o.lat,o.lon),t.KtG(l.rememberPlace(o))}),t.TgZ(1,"span"),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4," , "),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.qZA(),t.TgZ(7,"span"),t._uU(8," , "),t.qZA(),t.TgZ(9,"span"),t._uU(10),t.qZA(),t._UZ(11,"div",10),t.qZA()}if(2&r){const e=n.$implicit,s=t.oxw(2);t.xp6(2),t.Oqu(e.name),t.xp6(4),t.Oqu(e.country),t.xp6(4),t.Oqu(e.state),t.xp6(1),t.Akn(s.getFlagStyle(e.country))}}function V(r,n){if(1&r&&(t.TgZ(0,"div",7),t.YNc(1,B,12,5,"div",8),t.ALo(2,"async"),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.lcZ(2,1,e.places$))}}function D(r,n){if(1&r){const e=t.EpF();t.TgZ(0,"div",11),t.NdJ("mouseenter",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.isMoreInfo=!0)})("mouseleave",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.isMoreInfo=!1)}),t.TgZ(1,"p",12),t._uU(2),t.qZA(),t._UZ(3,"div",13),t.TgZ(4,"p"),t._uU(5),t.ALo(6,"date"),t.qZA(),t.TgZ(7,"p"),t._uU(8),t.qZA(),t.TgZ(9,"div",14)(10,"p",15),t._uU(11),t.qZA(),t.TgZ(12,"p",16),t.ALo(13,"async"),t._uU(14),t.qZA(),t.TgZ(15,"p",17),t._uU(16),t.qZA()(),t.TgZ(17,"p"),t._uU(18),t.qZA(),t.TgZ(19,"p"),t._uU(20),t.qZA(),t.TgZ(21,"p"),t._uU(22),t.qZA(),t.TgZ(23,"p"),t._uU(24),t.qZA(),t.TgZ(25,"p"),t._uU(26),t.qZA()()}if(2&r){const e=n.ngrxLet,s=t.oxw();t.ekj("container-appear",s.isChosen&&e)("more",s.isMoreInfo),t.xp6(2),t.AsE("",null==e?null:e.name," , ",null==e||null==e.sys?null:e.sys.country,""),t.xp6(1),t.Akn(s.getFlagStyle(null==e||null==e.sys?null:e.sys.country)),t.xp6(2),t.Oqu(t.xi3(6,21,s.getTime(null==e?null:e.dt),"long")),t.xp6(3),t.Oqu(null==e||null==e.weather[0]?null:e.weather[0].main),t.xp6(3),t.Oqu(null==e||null==e.weather[0]?null:e.weather[0].description),t.xp6(1),t.Akn("color:"+t.lcZ(13,24,s.tempColor$$)),t.xp6(2),t.hij(" ",null==e||null==e.main?null:e.main.temp.toFixed(1)," \u2103 "),t.xp6(2),t.hij("Feels like: ",null==e||null==e.main?null:e.main.feels_like.toFixed(1)," \u2103"),t.xp6(2),t.AsE(" min...max: ",null==e||null==e.main?null:e.main.temp_min.toFixed(1)," ... ",null==e||null==e.main?null:e.main.temp_max.toFixed(1)," \u2103 "),t.xp6(2),t.hij("Pressure: ",s.convertPressure(null==e||null==e.main?null:e.main.pressure)," mmHG"),t.xp6(2),t.hij("Humidity: ",null==e||null==e.main?null:e.main.humidity," %"),t.xp6(2),t.hij("Cloudnees: ",null==e||null==e.clouds?null:e.clouds.all," %"),t.xp6(2),t.hij("Wind: ",null==e||null==e.wind?null:e.wind.speed," m/s")}}class C{constructor(n,e,s,i,o,l,w){this.storage=n,this.searchService=e,this.requestService=s,this.http=i,this.rememberPlaces=o,this.getCurrentPlace=l,this.colorService=w,this.isMoreInfo=!1,this.searchRequest="",this.places$=this.searchService.findPlaces(),this.isChosen=!1,this.tempColor$$=this.colorService.emitColor()}ngOnInit(){this.searchRequest=this.storage.getItem(a.E9)||"",this.subscription1=this.requestService.getRequest().subscribe(n=>{this.searchRequest=n,this.isChosen=!1,this.rememberSearch()}),this.subscription2=this.getCurrentPlace.getPlace().subscribe(n=>{this.getCurrentWeather(n.latitude,n.longitude),this.searchRequest=n.city,this.rememberSearch()}),this.subscription3=this.requestService.getCoords().subscribe(n=>{this.getCurrentWeather(...n),this.isChosen=!0})}rememberSearch(){this.storage.setItem(a.E9,this.searchRequest)}findPlaces(){this.isChosen=!1,this.requestService.setRequest(this.searchRequest)}getCurrentWeather(n,e){this.isChosen=!0;let s=this.storage.getItem(a.bn)||"en";n&&e&&(this.currentWeather$=this.http.getCurrentWeather(n,e,"metric",s),this.subscription4=this.currentWeather$.subscribe(i=>this.colorService.setTemp(i?.main?.temp)))}getTime(n){return new Date(1e3*n)}rememberPlace(n){this.rememberPlaces.remember(n)}convertPressure(n){return(.750062*n).toFixed(0)}getFlagStyle(n){return n?`background-image: url(assets/img/png/${n?.toLowerCase()}.png)`:""}ngOnDestroy(){this.subscription1?.unsubscribe(),this.subscription2?.unsubscribe(),this.subscription3?.unsubscribe(),this.subscription4?.unsubscribe()}static#t=this.\u0275fac=function(e){return new(e||C)(t.Y36(I.V),t.Y36(x),t.Y36(p),t.Y36(d),t.Y36(h),t.Y36(v),t.Y36(X.x))};static#e=this.\u0275cmp=t.Xpm({type:C,selectors:[["app-main"]],viewQuery:function(e,s){if(1&e&&t.Gf(m,5),2&e){let i;t.iGM(i=t.CRH())&&(s.lastPlaces=i.first)}},decls:10,vars:8,consts:[[1,"main-container"],[1,"input-container"],["type","search","autofocus","",1,"input-search",3,"placeholder","ngModel","ngModelChange"],["class","places-container",4,"ngIf"],[1,"loading"],["class","forecast-container",3,"container-appear","more","mouseenter","mouseleave",4,"ngrxLet"],[1,"last-places"],[1,"places-container"],["class","place-item",3,"click",4,"ngFor","ngForOf"],[1,"place-item",3,"click"],[1,"flag-small"],[1,"forecast-container",3,"mouseenter","mouseleave"],[1,"place"],[1,"flag"],[1,"current-temp"],[1,"description"],[1,"temp"],[1,"feels-like"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"input",2),t.NdJ("ngModelChange",function(o){return s.searchRequest=o})("ngModelChange",function(){return s.rememberSearch(),s.findPlaces()}),t.qZA()(),t.YNc(3,V,3,3,"div",3),t.TgZ(4,"div",4),t.ALo(5,"async"),t.TgZ(6,"p"),t._uU(7,"LOADING..."),t.qZA()(),t.YNc(8,D,27,26,"div",5),t._UZ(9,"app-last-places",6),t.qZA()),2&e&&(t.xp6(2),t.Q6J("placeholder","search place")("ngModel",s.searchRequest),t.xp6(1),t.Q6J("ngIf",0==s.isChosen),t.xp6(1),t.ekj("visible",s.isChosen&&!t.lcZ(5,6,s.currentWeather$)),t.xp6(4),t.Q6J("ngrxLet",s.currentWeather$))},dependencies:[u.sg,u.O5,A.Fj,A.JJ,A.On,Z.eJ,m,u.Ov,u.uU],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}.input-container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;padding-top:50px}.places-container[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px;padding-top:50px;transition:.5s}.forecast-container[_ngcontent-%COMP%]{margin:50px auto 100px;transform:scale(0);width:300px;height:230px;overflow:hidden;align-items:center;justify-content:flex-start;flex-direction:column;gap:5px;padding:10px;background-color:#cceeffb3;box-shadow:1px 1px 2px #0486f180;border-radius:5px;color:#000;transition:.5s}.forecast-container[_ngcontent-%COMP%]:hover{opacity:1;background-color:#cef;box-shadow:1px 1px 5px #646464}.more[_ngcontent-%COMP%]{height:300px}.container-appear[_ngcontent-%COMP%]{transform:scale(1)}.place-item[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;justify-content:space-evenly;width:300px;min-width:50px;height:-moz-fit-content;height:fit-content;opacity:.7;background-color:#cceeffb3;box-shadow:1px 1px 2px #0486f1}.place-item[_ngcontent-%COMP%]:hover{opacity:1;background-color:#cef;box-shadow:1px 1px 5px #646464;transition:.2s}.last-places[_ngcontent-%COMP%]{position:absolute;top:50px;left:10px;margin-left:auto;margin-right:auto;padding-bottom:100px}.current-temp[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:space-evenly;width:180px;height:150px;background-color:#fff;box-shadow:1px 1px 2px #646464;border-radius:5px}.temp[_ngcontent-%COMP%]{font-size:24px}.feels-like[_ngcontent-%COMP%]{color:#999}.description[_ngcontent-%COMP%]{color:#000}.place[_ngcontent-%COMP%]{color:#4c6df0;font-size:24px}.flag[_ngcontent-%COMP%]{width:36px;height:24px;background-repeat:no-repeat;background-size:cover}.flag-small[_ngcontent-%COMP%]{width:22px;height:14px;background-repeat:no-repeat;background-size:cover}.loading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:300px;margin-left:auto;margin-right:auto;margin-top:100px;opacity:0;visibility:hidden;transform:.1s}.visible[_ngcontent-%COMP%]{opacity:1;visibility:visible}@media (max-width: 980px){.last-places[_ngcontent-%COMP%]{position:static}}"]})}const tt=[{path:"",component:C},{path:"**",component:_}];class b{static#t=this.\u0275fac=function(e){return new(e||b)};static#e=this.\u0275mod=t.oAB({type:b});static#n=this.\u0275inj=t.cJS({imports:[$.Bz.forChild(tt),$.Bz]})}var et=c(294),nt=c(4466);class P{static#t=this.\u0275fac=function(e){return new(e||P)};static#e=this.\u0275mod=t.oAB({type:P});static#n=this.\u0275inj=t.cJS({imports:[u.ez,b,et.I,nt.m,Z._N]})}}}]);