"use strict";(self.webpackChunkweather_forecast=self.webpackChunkweather_forecast||[]).push([[802],{9802:(K,T,o)=>{o.r(T),o.d(T,{MainModule:()=>P});var u=o(6895),q=o(3128),t=o(8256);class y{static#t=this.\u0275fac=function(e){return new(e||y)};static#e=this.\u0275cmp=t.Xpm({type:y,selectors:[["app-not-found"]],decls:2,vars:0,template:function(e,s){1&e&&(t.TgZ(0,"p"),t._uU(1,"not-found works!"),t.qZA())}})}var l=o(4854),Z=o(1135),I=o(2323);class p{constructor(n){this.storage=n,this.placesArray$$=new Z.X([])}remember(n){let e=this.getLastPlaces();e.some(s=>s.name===n.name&&s.country===n.country&&s.state===n.state)||(e.push(n),this.storage.setItem(l.I,JSON.stringify(e)),this.emitPlaces())}getLastPlaces(){return JSON.parse(this.storage.getItem(l.I)||"[]")}emitPlaces(){this.placesArray$$.next(this.getLastPlaces())}getSubject(){return this.emitPlaces(),this.placesArray$$}clearPlaces(){this.storage.setItem(l.I,JSON.stringify([])),this.emitPlaces()}static#t=this.\u0275fac=function(e){return new(e||p)(t.LFG(I.V))};static#e=this.\u0275prov=t.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"})}class h{constructor(){this.request$$=new Z.X(""),this.coords$$=new Z.X([void 0,void 0])}getRequest(){return this.request$$}getCoords(){return this.coords$$}setRequest(n){let e=n.trim();this.request$$.next(e.length>3?e:"")}setCoords(n,e){this.coords$$.next([n,e])}static#t=this.\u0275fac=function(e){return new(e||h)};static#e=this.\u0275prov=t.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})}function S(c,n){if(1&c){const e=t.EpF();t.TgZ(0,"div",3),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.callPlace(r))}),t.TgZ(1,"p"),t._uU(2),t.qZA()()}if(2&c){const e=n.$implicit;t.xp6(2),t.lnq("",null==e?null:e.name,", ",null==e?null:e.country,", ",null==e?null:e.state,"")}}class g{constructor(n,e){this.rememberPlaces=n,this.requestService=e,this.places$$=this.rememberPlaces.getSubject()}callPlace(n){this.requestService.setRequest(n.name),this.requestService.setCoords(n.lat,n.lon)}clear(){this.rememberPlaces.clearPlaces()}static#t=this.\u0275fac=function(e){return new(e||g)(t.Y36(p),t.Y36(h))};static#e=this.\u0275cmp=t.Xpm({type:g,selectors:[["app-last-places"]],decls:8,vars:7,consts:[[1,"places-container"],[1,"clear",3,"click"],["class","item-container",3,"click",4,"ngFor","ngForOf"],[1,"item-container",3,"click"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0)(1,"p"),t._uU(2,"Last searching:"),t.qZA(),t.TgZ(3,"button",1),t.NdJ("click",function(){return s.clear()}),t.ALo(4,"async"),t._uU(5," Clear "),t.qZA(),t.YNc(6,S,3,3,"div",2),t.ALo(7,"async"),t.qZA()),2&e&&(t.xp6(3),t.ekj("disabled",t.lcZ(4,3,s.places$$).length<1),t.xp6(3),t.Q6J("ngForOf",t.lcZ(7,5,s.places$$)))},dependencies:[u.sg,u.Ov],styles:["*[_ngcontent-%COMP%]{padding:0;margin:0}.places-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:200px;height:100%;overflow-y:auto;overflow-x:hidden;gap:10px;padding:10px}.item-container[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;justify-content:center;width:180px;height:-moz-fit-content;height:fit-content;opacity:.7;background-color:#cceeff4d;box-shadow:1px 1px 2px #0486f1}.item-container[_ngcontent-%COMP%]:hover{opacity:1;box-shadow:1px 1px 5px #646464;background-color:#cef;transition:.2s}.clear[_ngcontent-%COMP%]{width:100px;margin-bottom:20px;border:5px solid transparent;cursor:pointer;opacity:.7;background-color:#cceeff4d}.clear[_ngcontent-%COMP%]:hover{opacity:1;background-color:#cef;box-shadow:1px 1px 5px #646464;transition:.2s}.disabled[_ngcontent-%COMP%]{cursor:auto;opacity:.7;background-color:#cceeff4d}.disabled[_ngcontent-%COMP%]:hover{opacity:.7;background-color:#cceeff4d;box-shadow:0 0 #646464}"]})}var U=o(9646),A=o(3900),k=o(727);class j extends k.w0{constructor(n,e){super()}schedule(n,e=0){return this}}const C={setInterval(c,n,...e){const{delegate:s}=C;return s?.setInterval?s.setInterval(c,n,...e):setInterval(c,n,...e)},clearInterval(c){const{delegate:n}=C;return(n?.clearInterval||clearInterval)(c)},delegate:void 0};var L=o(8737);const M={now:()=>(M.delegate||Date).now(),delegate:void 0};class m{constructor(n,e=m.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,s){return new this.schedulerActionCtor(this,n).schedule(s,e)}}m.now=M.now;const N=new class J extends m{constructor(n,e=m.now){super(n,e),this.actions=[],this._active=!1}flush(n){const{actions:e}=this;if(this._active)return void e.push(n);let s;this._active=!0;do{if(s=n.execute(n.state,n.delay))break}while(n=e.shift());if(this._active=!1,s){for(;n=e.shift();)n.unsubscribe();throw s}}}(class Y extends j{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){var s;if(this.closed)return this;this.state=n;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,e)),this.pending=!0,this.delay=e,this.id=null!==(s=this.id)&&void 0!==s?s:this.requestAsyncId(r,this.id,e),this}requestAsyncId(n,e,s=0){return C.setInterval(n.flush.bind(n,this),s)}recycleAsyncId(n,e,s=0){if(null!=s&&this.delay===s&&!1===this.pending)return e;null!=e&&C.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const s=this._execute(n,e);if(s)return s;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let i,s=!1;try{this.work(n)}catch(r){s=!0,i=r||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:n,scheduler:e}=this,{actions:s}=e;this.work=this.state=this.scheduler=null,this.pending=!1,(0,L.P)(s,this),null!=n&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}});var R=o(4482),z=o(5403),O=o(529);class d{constructor(n){this.http=n}getPlaces(n){return this.http.get(l.Em+`?q=${n}&limit=5&appid=${l.$h}`)}getCurrentWeather(n,e,s="metric",i="en"){return this.http.get(l.LX+`lat=${n}&lon=${e}&appid=${l.$h}&units=${s}&lang=${i}`)}static#t=this.\u0275fac=function(e){return new(e||d)(t.LFG(O.eN))};static#e=this.\u0275prov=t.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}class x{constructor(n,e){this.http=n,this.requestService=e,this.places=(0,U.of)([])}findPlaces(){return this.places.pipe((0,A.w)(()=>this.requestService.getRequest()),function W(c,n=N){return(0,R.e)((e,s)=>{let i=null,r=null,a=null;const _=()=>{if(i){i.unsubscribe(),i=null;const f=r;r=null,s.next(f)}};function H(){const f=a+c,F=n.now();if(F<f)return i=this.schedule(void 0,f-F),void s.add(i);_()}e.subscribe((0,z.x)(s,f=>{r=f,a=n.now(),i||(i=n.schedule(H,c),s.add(i))},()=>{_(),s.complete()},void 0,()=>{r=i=null}))})}(1e3),(0,A.w)(n=>(n||(n=" "),this.http.getPlaces(n))))}static#t=this.\u0275fac=function(e){return new(e||x)(t.LFG(d),t.LFG(h))};static#e=this.\u0275prov=t.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"})}var E=o(4004);class v{constructor(n){this.http=n}getIP(){return this.http.get("https://jsonip.com")}getPlace(){return this.getIP().pipe((0,E.U)(n=>n.ip),(0,A.w)(n=>this.http.get(`http://www.geoplugin.net/json.gp?ip=${n}`)))}static#t=this.\u0275fac=function(e){return new(e||v)(t.LFG(O.eN))};static#e=this.\u0275prov=t.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"})}var $=o(433);function G(c,n){if(1&c){const e=t.EpF();t.TgZ(0,"div",8),t.NdJ("click",function(){const r=t.CHM(e).$implicit,a=t.oxw(2);return a.getCurrentWeather(r.lat,r.lon),t.KtG(a.rememberPlace(r))}),t.TgZ(1,"span"),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4," , "),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.qZA(),t.TgZ(7,"span"),t._uU(8," , "),t.qZA(),t.TgZ(9,"span"),t._uU(10),t.qZA()()}if(2&c){const e=n.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(4),t.Oqu(e.country),t.xp6(4),t.Oqu(e.state)}}function Q(c,n){if(1&c&&(t.TgZ(0,"div",6),t.YNc(1,G,11,3,"div",7),t.ALo(2,"async"),t.qZA()),2&c){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.lcZ(2,1,e.places$))}}function X(c,n){if(1&c&&(t.TgZ(0,"div",9)(1,"p",10),t._uU(2),t.qZA(),t.TgZ(3,"p"),t._uU(4),t.ALo(5,"date"),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.qZA(),t.TgZ(8,"p"),t._uU(9),t.qZA(),t.TgZ(10,"div",11)(11,"p"),t._uU(12),t.qZA()(),t.TgZ(13,"p"),t._uU(14),t.qZA(),t.TgZ(15,"p"),t._uU(16),t.qZA(),t.TgZ(17,"p"),t._uU(18),t.qZA(),t.TgZ(19,"p"),t._uU(20),t.qZA(),t.TgZ(21,"p"),t._uU(22),t.qZA(),t.TgZ(23,"p"),t._uU(24),t.qZA()()),2&c){const e=n.ngIf,s=t.oxw();t.xp6(2),t.AsE("",null==e?null:e.name," , ",null==e||null==e.sys?null:e.sys.country,""),t.xp6(2),t.Oqu(t.xi3(5,13,s.getTime(null==e?null:e.dt),"long")),t.xp6(3),t.Oqu(null==e||null==e.weather[0]?null:e.weather[0].main),t.xp6(2),t.Oqu(null==e||null==e.weather[0]?null:e.weather[0].description),t.xp6(3),t.hij("",null==e||null==e.main?null:e.main.temp," \u2103"),t.xp6(2),t.hij("Feels like: ",null==e||null==e.main?null:e.main.feels_like," \u2103"),t.xp6(2),t.AsE(" min...max: ",null==e||null==e.main?null:e.main.temp_min," ... ",null==e||null==e.main?null:e.main.temp_max," \u2103 "),t.xp6(2),t.hij("Pressure: ",null==e||null==e.main?null:e.main.pressure," KPa"),t.xp6(2),t.hij("Humidity: ",null==e||null==e.main?null:e.main.humidity," %"),t.xp6(2),t.hij("Cloudnees: ",null==e||null==e.clouds?null:e.clouds.all," %"),t.xp6(2),t.hij("Wind: ",null==e||null==e.wind?null:e.wind.speed," m/s")}}class w{constructor(n,e,s,i,r,a){this.storage=n,this.searchService=e,this.requestService=s,this.http=i,this.rememberPlaces=r,this.getCurrentPlace=a,this.searchRequest="",this.places$=this.searchService.findPlaces(),this.isChosen=!1}ngOnInit(){this.searchRequest=this.storage.getItem(l.E9)||"",this.subscription1=this.requestService.getRequest().subscribe(n=>{this.searchRequest=n,this.isChosen=!1,this.rememberSearch()}),this.subscription2=this.getCurrentPlace.getPlace().subscribe(n=>{this.getCurrentWeather(n.geoplugin_latitude,n.geoplugin_longitude),this.searchRequest=n.geoplugin_city,this.rememberSearch()}),this.subscription3=this.requestService.getCoords().subscribe(n=>{this.getCurrentWeather(...n),this.isChosen=!0})}rememberSearch(){this.storage.setItem(l.E9,this.searchRequest)}findPlaces(){this.isChosen=!1,this.requestService.setRequest(this.searchRequest)}getCurrentWeather(n,e){this.isChosen=!0;let s=this.storage.getItem(l.bn)||"en";n&&e&&(this.currentWeather$=this.http.getCurrentWeather(n,e,"metric",s))}getTime(n){return new Date(1e3*n)}rememberPlace(n){this.rememberPlaces.remember(n)}ngOnDestroy(){this.subscription1?.unsubscribe(),this.subscription2?.unsubscribe(),this.subscription3?.unsubscribe()}static#t=this.\u0275fac=function(e){return new(e||w)(t.Y36(I.V),t.Y36(x),t.Y36(h),t.Y36(d),t.Y36(p),t.Y36(v))};static#e=this.\u0275cmp=t.Xpm({type:w,selectors:[["app-main"]],viewQuery:function(e,s){if(1&e&&t.Gf(g,5),2&e){let i;t.iGM(i=t.CRH())&&(s.lastPlaces=i.first)}},decls:7,vars:6,consts:[[1,"main-container"],[1,"input-container"],["type","search","autofocus","",1,"input-search",3,"placeholder","ngModel","ngModelChange"],[1,"last-places"],["class","places-container",4,"ngIf"],["class","forecast-container",4,"ngIf"],[1,"places-container"],["class","place-item",3,"click",4,"ngFor","ngForOf"],[1,"place-item",3,"click"],[1,"forecast-container"],[1,"place"],[1,"current-temp"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"input",2),t.NdJ("ngModelChange",function(r){return s.searchRequest=r})("ngModelChange",function(){return s.rememberSearch(),s.findPlaces()}),t.qZA()(),t._UZ(3,"app-last-places",3),t.YNc(4,Q,3,3,"div",4),t.YNc(5,X,25,16,"div",5),t.ALo(6,"async"),t.qZA()),2&e&&(t.xp6(2),t.Q6J("placeholder","search place")("ngModel",s.searchRequest),t.xp6(2),t.Q6J("ngIf",0==s.isChosen),t.xp6(1),t.Q6J("ngIf",s.isChosen&&t.lcZ(6,4,s.currentWeather$)))},dependencies:[u.sg,u.O5,$.Fj,$.JJ,$.On,g,u.Ov,u.uU],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}.input-container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;padding-top:50px}.places-container[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px;padding-top:50px}.forecast-container[_ngcontent-%COMP%]{margin:50px auto 100px;width:300px;min-height:300px;height:-moz-fit-content;height:fit-content;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:5px;padding-top:10px;background-color:#cceeff4d;box-shadow:1px 1px 2px #0486f180;border-radius:5px}.forecast-container[_ngcontent-%COMP%]:hover{opacity:1;background-color:#cef;box-shadow:1px 1px 5px #646464;transition:.2s}.place-item[_ngcontent-%COMP%]{cursor:pointer;width:300px;min-width:50px;height:-moz-fit-content;height:fit-content;opacity:.7;background-color:#cceeff4d;box-shadow:1px 1px 2px #0486f1}.place-item[_ngcontent-%COMP%]:hover{opacity:1;background-color:#cef;box-shadow:1px 1px 5px #646464;transition:.2s}.last-places[_ngcontent-%COMP%]{position:absolute;left:10px;top:50px}.current-temp[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100px;height:100px;background-color:#eee;box-shadow:1px 1px 2px #646464;color:#4c6df0;font-size:24px;border-radius:5px}.place[_ngcontent-%COMP%]{color:#4c6df0;font-size:24px}"]})}const B=[{path:"",component:w},{path:"**",component:y}];class b{static#t=this.\u0275fac=function(e){return new(e||b)};static#e=this.\u0275mod=t.oAB({type:b});static#n=this.\u0275inj=t.cJS({imports:[q.Bz.forChild(B),q.Bz]})}var V=o(294),D=o(4466);class P{static#t=this.\u0275fac=function(e){return new(e||P)};static#e=this.\u0275mod=t.oAB({type:P});static#n=this.\u0275inj=t.cJS({imports:[u.ez,b,V.I,D.m]})}}}]);