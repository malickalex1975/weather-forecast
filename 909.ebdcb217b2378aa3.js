"use strict";(self.webpackChunkweather_forecast=self.webpackChunkweather_forecast||[]).push([[909],{909:(T,M,g)=>{g.r(M),g.d(M,{CameraGameModule:()=>f});var y=g(6895),_=g(9197),C=g(5861),O=g(1135),t=g(4650);class m{constructor(){this.isBigCanvas=!1,this.dataArray=[],this.averageR=0,this.averageG=0,this.averageB=0,this.averageA=1,this.pointR="-",this.pointG="-",this.pointB="-",this.pointA="-",this.pointColor="rgba(0,0,0,1)",this.isSaveButton=!1,this.dataUrl="",this.x="-",this.y="-",this.isMouseDown=!1}ngOnInit(){this.averageColor$$=new O.X("rgba(0,0,0,1)"),document.querySelector(".controls");const i=document.querySelector(".video-options>select"),n=document.querySelector("video"),o=document.querySelector(".canvas"),e=document.querySelector(".canvas-2");e.width=300,e.height=300,document.addEventListener("mousedown",()=>this.isMouseDown=!0),document.addEventListener("mouseup",()=>this.isMouseDown=!1),e.addEventListener("mouseleave",()=>{this.x="-",this.y="-",this.pointR="-",this.pointG="-",this.pointB="-",this.pointA="-"}),e.addEventListener("mousemove",r=>{this.isSaveButton=!0;let u=e.getBoundingClientRect().x,d=e.getBoundingClientRect().y;this.x=Math.floor(r.clientX-u),this.y=Math.floor(r.clientY-d),this.isMouseDown?this.drawCanvas(this.x,this.y):this.isMouseDown||this.definePoint(this.x,this.y)});const h=document.querySelector("img"),p=document.querySelectorAll(".btn");let l=!1;const[s,c,A]=[...p],P={video:!0};function b(){return(b=(0,C.Z)(function*(){const d=(yield navigator.mediaDevices.enumerateDevices()).filter(v=>"videoinput"===v.kind).map(v=>`<option value="${v.deviceId}">${v.label}</option>`);i.innerHTML=d.join("")})).apply(this,arguments)}s.onclick=(0,C.Z)(function*(){if(l)n.play();else if("mediaDevices"in navigator){const r={...P,deviceId:{exact:i.value}};Z(r)}});const Z=function(){var r=(0,C.Z)(function*(u){const d=yield navigator.mediaDevices.getUserMedia(u);U(d)});return function(d){return r.apply(this,arguments)}}(),U=r=>{n.srcObject=r,l=!0,this.isSaveButton=!1};i.onchange=()=>{const r={...P,deviceId:{exact:i.value}};Z(r)},c.onclick=()=>{n.pause()},A.onclick=()=>{o.width=n.videoWidth,o.height=n.videoHeight,o.getContext("2d").drawImage(n,0,0),h.src=o.toDataURL("image/webp");let u=o.getContext("2d")?.getImageData(0,0,n.videoWidth,n.videoHeight),d=new ImageData(this.createMonoImage(u.data),n.videoWidth,n.videoHeight,{colorSpace:"srgb"});e.getContext("2d")?.putImageData(d,0,0)},function S(){b.apply(this,arguments)}()}createAverageColor(a){let i=Array.from(a.data),o=i.length/4,e=[],h=[],p=[],l=[];for(let s=0;s<o;s++)e.push(i[4*s+0]),h.push(i[4*s+1]),p.push(i[4*s+2]),l.push(i[4*s+3]);this.averageR=Math.round(e.reduce((s,c)=>s+c,0)/o),this.averageG=Math.round(h.reduce((s,c)=>s+c,0)/o),this.averageB=Math.round(p.reduce((s,c)=>s+c,0)/o),this.averageA=Number((Math.round(l.reduce((s,c)=>s+c,0)/o)/255).toFixed(2)),this.averageColor$$?.next(`rgba(${this.averageR},${this.averageG},${this.averageB},${this.averageA}`)}createMonoImage(a){let i=a.length,n=i/4,o=new Uint8ClampedArray(i);for(let e=0;e<n;e++){let s=Math.round((a[4*e+0]+a[4*e+1]+a[4*e+2])/3);o[4*e+0]=s,o[4*e+1]=s,o[4*e+2]=s,o[4*e+3]=a[4*e+3]}return o}createInverseImage(a){let i=a.length,n=i/4,o=new Uint8ClampedArray(i);for(let e=0;e<n;e++)o[4*e+0]=Math.abs(a[4*e+0]-255),o[4*e+1]=Math.abs(a[4*e+1]-255),o[4*e+2]=Math.abs(a[4*e+2]-255),o[4*e+3]=a[4*e+3];return o}drawCanvas(a,i){let o=document.querySelector(".canvas-2").getContext("2d");if(!this.isMouseDown)return void o.beginPath();o.strokeStyle="red",o.lineTo(a,i),o.stroke();let e=o.getImageData(0,0,300,300);setTimeout(()=>this.createAverageColor(e),0)}clearCanvas(){this.isSaveButton=!1;const a=document.querySelector(".canvas-2");a.width=300,a.height=300;let i=a.getContext("2d");i.beginPath(),i.clearRect(0,0,a.width,a.height),this.drawCanvas(0,0)}getHref(){const a=document.querySelector(".canvas-2"),i=document.querySelector(".save-button");this.dataUrl=a.toDataURL("image/webp"),this.dataUrl&&(this.isSaveButton=!0,i.href=this.dataUrl)}definePoint(a,i){let o=document.querySelector(".canvas-2").getContext("2d");o.beginPath();let e=o.getImageData(a,i,1,1);this.pointR=e.data[0],this.pointG=e.data[1],this.pointB=e.data[2],this.pointA=Math.round(e.data[3]/255),this.pointColor=`rgba(${this.pointR},${this.pointG},${this.pointB},${this.pointA})`}static#t=this.\u0275fac=function(i){return new(i||m)};static#e=this.\u0275cmp=t.Xpm({type:m,selectors:[["app-camera-game"]],decls:47,vars:21,consts:[[1,"display-cover"],["autoplay","","controls","true"],["draggable","true",1,"canvas","d-none",3,"click"],[1,"canvas-2"],[1,"video-options"],["name","","id","",1,"custom-select"],["value",""],["href","#",1,"save-button",3,"download","click"],[1,"average-color"],[1,"point-color"],[1,"point-data"],[1,"average-data"],["alt","",1,"screenshot-image","d-none"],[1,"controls"],["title","Play",1,"btn","btn-danger","play"],["data-feather","play-circle"],["title","Pause",1,"btn","btn-info","pause","d-none"],["data-feather","pause"],["title","ScreenShot",1,"btn","btn-outline-success","screenshot","d-none"],["data-feather","image"],[3,"click"]],template:function(i,n){1&i&&(t.TgZ(0,"div",0),t._UZ(1,"video",1),t.TgZ(2,"canvas",2),t.NdJ("click",function(){return n.isBigCanvas=!n.isBigCanvas}),t.qZA(),t._UZ(3,"canvas",3),t.TgZ(4,"div",4)(5,"select",5)(6,"option",6),t._uU(7,"Select camera"),t.qZA()()(),t.TgZ(8,"a",7),t.NdJ("click",function(){return n.getHref()}),t._uU(9,"Save"),t.qZA(),t.TgZ(10,"div",8),t.ALo(11,"async"),t._uU(12,"Average colour"),t.qZA(),t.TgZ(13,"div",9),t._uU(14,"Point colour"),t.qZA(),t.TgZ(15,"div",10)(16,"p"),t._uU(17),t.qZA(),t.TgZ(18,"p"),t._uU(19),t.qZA(),t.TgZ(20,"p"),t._uU(21),t.qZA(),t.TgZ(22,"p"),t._uU(23),t.qZA(),t.TgZ(24,"p"),t._uU(25),t.qZA(),t.TgZ(26,"p"),t._uU(27),t.qZA()(),t.TgZ(28,"div",11)(29,"p"),t._uU(30),t.qZA(),t.TgZ(31,"p"),t._uU(32),t.qZA(),t.TgZ(33,"p"),t._uU(34),t.qZA(),t.TgZ(35,"p"),t._uU(36),t.qZA()(),t._UZ(37,"img",12),t.TgZ(38,"div",13)(39,"button",14),t._UZ(40,"i",15),t.qZA(),t.TgZ(41,"button",16),t._UZ(42,"i",17),t.qZA(),t.TgZ(43,"button",18),t._UZ(44,"i",19),t.qZA(),t.TgZ(45,"button",20),t.NdJ("click",function(){return n.clearCanvas()}),t._uU(46,"clear canvas"),t.qZA()()()),2&i&&(t.xp6(2),t.Udp("width",n.isBigCanvas?"40vw":"20vw"),t.xp6(6),t.ekj("visible",n.isSaveButton),t.Q6J("download","my_photo.png"),t.xp6(2),t.Udp("background-color",t.lcZ(11,19,n.averageColor$$)),t.xp6(3),t.Udp("background-color",n.pointColor),t.xp6(4),t.hij("X= ",n.x,""),t.xp6(2),t.hij("Y= ",n.y,""),t.xp6(2),t.hij("R: ",n.pointR,""),t.xp6(2),t.hij("G: ",n.pointG,""),t.xp6(2),t.hij("B: ",n.pointB,""),t.xp6(2),t.hij("A: ",n.pointA,""),t.xp6(3),t.hij("R: ",n.averageR,""),t.xp6(2),t.hij("G: ",n.averageG,""),t.xp6(2),t.hij("B: ",n.averageB,""),t.xp6(2),t.hij("A: ",n.averageA,""))},dependencies:[y.Ov],styles:[".screenshot-image[_ngcontent-%COMP%]{width:150px;height:90px;border-radius:4px;border:2px solid whitesmoke;box-shadow:0 1px 2px #0000001a;position:absolute;top:60px;left:10px;background:white}.canvas[_ngcontent-%COMP%]{position:fixed;right:50px;bottom:50px;width:20vw;padding:50px}.canvas-2[_ngcontent-%COMP%]{position:fixed;left:50px;bottom:50px;width:300px;height:300px;padding:0;border:2px solid rgb(236,36,36);background-color:#000}.save-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;text-decoration:none;width:50px;height:30px;position:fixed;left:0;bottom:170px;opacity:0;visibility:hidden}.save-button[_ngcontent-%COMP%]:hover{background-color:#eee}.visible[_ngcontent-%COMP%]{opacity:1;visibility:visible}.average-color[_ngcontent-%COMP%]{position:fixed;left:400px;bottom:50px;width:50px;height:50px;border:2px solid red;padding:30px}.point-color[_ngcontent-%COMP%]{position:fixed;left:400px;bottom:180px;width:50px;height:50px;border:2px solid green;padding:30px}.display-cover[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:70%;margin:5% auto;position:relative}video[_ngcontent-%COMP%]{width:400px;background:rgba(0,0,0,.2)}.video-options[_ngcontent-%COMP%]{position:absolute;left:20px;top:30px}.controls[_ngcontent-%COMP%]{position:fixed;right:20px;top:120px;display:flex}.controls[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{color:#fff!important}@media (min-width: 300px) and (max-width: 400px){.controls[_ngcontent-%COMP%]{flex-direction:column}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:5px 0!important}}.controls[_ngcontent-%COMP%] > button[_ngcontent-%COMP%] > svg[_ngcontent-%COMP%]{height:20px;width:18px;text-align:center;margin:0 auto;padding:0}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(1){border:2px solid #D2002E}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(1)   svg[_ngcontent-%COMP%]{color:#d2002e}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(2){border:2px solid #008496}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(2)   svg[_ngcontent-%COMP%]{color:#008496}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(3){border:2px solid #00B541}.controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(3)   svg[_ngcontent-%COMP%]{color:#00b541}.controls[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{width:45px;height:45px;text-align:center;border-radius:100%;margin:0 6px;background:transparent}.controls[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{color:#fff}.average-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100px;height:120px;border:1px dashed red;border-radius:5px;position:fixed;left:550px;bottom:50px}.point-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100px;height:120px;border:1px dashed green;border-radius:5px;position:fixed;left:550px;bottom:180px}"]})}const w=[{path:"",component:m}];class x{static#t=this.\u0275fac=function(i){return new(i||x)};static#e=this.\u0275mod=t.oAB({type:x});static#n=this.\u0275inj=t.cJS({imports:[_.Bz.forChild(w),_.Bz]})}class f{static#t=this.\u0275fac=function(i){return new(i||f)};static#e=this.\u0275mod=t.oAB({type:f});static#n=this.\u0275inj=t.cJS({imports:[y.ez,x]})}}}]);